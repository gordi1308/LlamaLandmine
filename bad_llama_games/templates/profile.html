{% extends "basic.html" %}
{% load staticfiles %}
 <!-- Bootstrap Core css -->
    <link href="{%  static "css/bootstrap.min.css" %}" rel="stylesheet">

    <!-- Custom css -->
    <link href="{%  static "css/sb-admin.css" %}" rel="stylesheet">
     <script src="{% static "js/libraries/jquery.easing.min.js"%}"></script>
     <script src="{%  static "js/libraries/bootstrap.min.js"%}"></script>
{% block extraJS %}
    <script src="{% static 'js/scripts/post_request_handler.js' %}"></script>
    <script src="{% static 'js/scripts/profile_script.js' %}"></script>
       <script>
 (function($) {
    $(function() {
      $(document).popover({ selector: '[data-toggle="popover"]' });

    });
  })(jQuery);

</script>
{% endblock %}
{% block body %}

<div class="container "> <!-- main container-->
    <h1 class="text-center text-orange text-uppercase"> {{ profile_username }}'s Page</h1>
    {% if not are_friends and not request_sent %}
        <div class="col-xs-2 col-md-2 col-sm-2 col-lg-2 col-xs-offset-5
        col-sm-offset-5 col-md-offset-5 col-lg-offset-5">
            <form action ="{% url 'profile' profile_username %}" method="post">
                {% csrf_token %}
                <input class="btn-primary btn-lg btn-block" type="submit"
                       name="add_friend_button" id="add_friend_button" value="Add Friend"/>
            </form>
        </div>
              <div><br><br><br><br><br></div>
    {% endif %}
    <div class="row"> <!--first row -->
        <div class="col-xs-9 col-sm-9 col-md-9 col-lg-9"> <!-- main div for badge and challenge-->
            <div class="row">     <!-- row for badges-->
                <div class="panel panel-black">    <!-- badge panel -->
                    <div class="panel-heading text-center text-orange">Recently Earned Badges
                        {% if is_your_page %}
                            <p class="text-right text-orange">
                                <a  href="#"   title="Badges" data-placement="left"
                                    data-toggle="popover" data-trigger="focus" data-content="{{ badge_list }}">See More</a>
                            </p>
                        {% endif %}
                    </div>    <!-- badge panel header open close-->
                    <div class="panel-bodyb">
                        {% for badge in badge_shortlist %}
                           <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3 table-bordered ">
                               <div class="row">
                                   <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                       <img src="/static/badges/{{ badge.icon }}"
                                            type="image/png" alt="badge"
                                            class="col-lg-12 col-xs-12 col-sm-12 col-md-12" />
                                   </div>
                               </div>
                               <div class="row">
                                   <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 ">
                                       <h4 class="  text-center  ">{{ badge.name }}</h4><br>
                                       <p class="text-center text-orange table-headingb"> {{ badge.description }}</p>
                                   </div>
                               </div>
                           </div>
                        {% endfor %}
                    </div>    <!-- badge panel content open close-->
                </div> <!-- badge panel close-->
            </div>   <!-- row for badges close -->
            <div class="row">     <!-- row for challenge-->
                <div class="panel panel-black">    <!-- challenge panel -->
                    <div class="panel-heading text-center text-orange">Ongoing Challenges</div> <!-- challenge panel header open close-->
                    <div class="panel-bodyb">
                        {% for challenge in ongoing_challenges %}
                            <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
                                <a class="text-capitalize" href='{% url 'profile' challenge.challenger %}'>
                                    {{ challenge.challenger }}</a>: {{ challenge.game.level }}
                                - {{ challenge.score_to_beat }} - {{ challenge.remaining_attempts }}
                            </div>
                        {% endfor %}
                    </div>    <!-- challenge panel content open close-->
                </div> <!-- challenge panel close-->
            </div>   <!-- row for challenge close -->
        </div> <!-- main div for badge and challenge close-->

        <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">    <!-- main div for friends and requests-->
            <div class="row"> <!-- friends table row-->
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <div class="panel panel-black">
                        <div class="panel-heading text-center">Friends</div>
                        <div class="panel-bodyb">
                            <div class="table-responsive">    <!--table div for friends-->
                                <table class="table table-primary">
                                    <tbody>
                                    {% for friend in friend_list %}
                                        <tr class="text-center">
                                            <td><a class="text-capitalize" href='{% url 'profile' friend.user.username %}'>
                                                {{ friend.user.username }}</a></td>    <!--table context for friends-->
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>      <!--table div for friends close-->
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">      <!-- row for friend request-->
                {% if is_your_page %}
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">    <!-- main div for friend request -->
                        <div class="panel panel-black">    <!-- friend request panel -->
                            <div class="panel-heading text-center">Friend Requests</div>    <!-- friend request panel header open close-->
                            <div class="panel-bodyb">
                                <div class="table-responsive">    <!--table div for friend request-->
                                    <table class="table">
                                        <tbody class="text-center">
                                        {% if request_list %}
                                            {% for request in request_list %}
                                                <tr>
                                                    <td> <a class="text-capitalize" href='{% url 'profile' request.user.user_name %}'>
                                                        {{ request.user.user_name }}</a></td>  <!--table context for friend request -->
                                                    <td><div class="btn-group btn-group-justified">
                                                        <div class="btn-group">
                                                            <button class="accept_request btn btn-success text-capitalize"
                                                                 name="{{ request.user.user_name }}">Accept</button>
                                                        </div>
                                                        <div class="btn-group">
                                                            <button class="decline_request btn btn-danger text-capitalize"
                                                                 name="{{ request.user.user_name }}">Decline</button>
                                                        </div>
                                                    </div></td>     <!--table context for friend request accept reject-->
                                                </tr>
                                            {% endfor %}
                                        {% else %}
                                            <tr class="text-center">
                                                No pending requests!
                                            </tr>
                                        {% endif %}
                                        </tbody>
                                    </table>
                                </div>    <!--table div for friend request close-->
                            </div>    <!-- friend request panel content open close-->
                        </div> <!-- friend request panel close-->
                    </div>   <!-- main div for friend request close -->
                {% endif %}
            </div>   <!-- row for friend request-->
        </div>   <!-- main div for friends and requests close -->
    </div>    <!--first row close-->

    <div class="row">       <!-- main row for stats and high score and ongoing challenges-->
        {% if is_your_page %}
            <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">    <!-- main div for ongoing -->
                <div class="panel panel-black">    <!-- ongoing panel -->
                    <div class="panel-heading text-center text-orange">Pending Challenges
                        <p class="text-right text-orange">
                            <a  href="#" title="Pending_Challenges"data-placement="left" data-toggle="popover"
                                data-trigger="focus" data-content="data">See More</a>
                        </p>
                    </div>    <!-- ongoing panel header open close-->
                    <div class="panel-bodyb">
                        {% if pending_challenges %}
                            {% for challenge in pending_challenges %}
                                <div>
                                    <a  href='{% url 'profile' challenge.challenger %}'>
                                                        {{ challenge.challenger }}</a>
                                    <button class="accept_challenge text-capitalize" name="{{ challenge.id }}">Accept</button>
                                    <button class="decline_challenge text-capitalize" name="{{ challenge.id }}">Decline</button>
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>    <!-- ongoing panel content open close-->
                </div> <!-- ongoing panel close-->
            </div>   <!-- main div for ongoing close -->
        {% endif %}

        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">    <!-- main div for stats -->
            <div class="panel panel-black">    <!-- stats panel -->
                <div class="panel-heading text-center">Game statistics</div>    <!-- stats panel header open close-->
                <div class="panel-bodyb">
                    <div class="table-responsive">    <!--table div for stats-->
                        <table class="table table-primary">
                            <thead>
                            <tr >
                                <th class="table-heading text-white text-center">Easy</th>    <!--table header for stats-->
                                <th class="table-heading text-white text-center">Medium</th>      <!--table header for stats-->
                                <th class="table-heading text-white text-center">Hard</th>               <!--table header for stats-->
                                <th class="table-heading text-white text-center">Challenge</th>               <!--table header for stats-->
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="text-center" >
                                <td>Played :{{ games_played_easy }}</td>          <!--table context for stats-->
                                <td>Played :{{ games_played_norm }}</td>          <!--table context for stats-->
                                <td>Played :{{ games_played_hard }}</td>          <!--table context for stats-->
                                <td>Recieved :{{ challenges_received }}</td>          <!--table context for stats-->
                            </tr>
                            <tr class="text-center" >
                                <td>Won :{{ games_won_easy }}</td>          <!--table context for stats-->
                                <td>Won :{{ games_won_norm }}</td>          <!--table context for stats-->
                                <td>Won :{{ games_won_hard }}</td>          <!--table context for stats-->
                                <td>Issued :{{ challenges_issued }}</td>          <!--table context for stats-->
                            </tr>
                            <tr class="text-center" >
                                <td>Win % :{{ percentage_easy }}</td>          <!--table context for stats-->
                                <td>Win % :{{ percentage_norm }}</td>          <!--table context for stats-->
                                <td>Win % :{{ percentage_hard }}</td>          <!--table context for stats-->
                                <td>Won :{{ challenges_won }}</td>          <!--table context for stats-->
                            </tr>
                            <tr class="text-center" >
                                <td></td>          <!--table context for stats-->
                                <td></td>          <!--table context for stats-->
                                <td></td>          <!--table context for stats-->
                                <td>Win % :{{ percent_challenge_win }}</td>          <!--table context for stats-->
                            </tr>
                            </tbody>
                        </table>
                    </div>                           <!--table div for stats close-->
                </div>    <!-- stats panel content open close-->
            </div> <!-- stats panel close-->
        </div>   <!-- main div for stats close -->
        <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">    <!-- main div for highscore -->
            <div class="panel panel-black">    <!-- highscore panel -->
                <div class="panel-heading text-center">High Scores</div>    <!-- highscore panel header open close-->
                <div class="panel-bodyb">
                    <p class="text-center"> Easy: {{ easy_high }}</p>
                    <p class="text-center"> Medium: {{ norm_high }}</p>
                    <p class="text-center"> Hard: {{ hard_high }}</p>
                </div>    <!-- highscore panel content open close-->
            </div> <!-- highscore panel close-->
        </div>   <!-- main div for highscore close -->
    </div>              <!-- main row for stats and high score and request close-->
</div> <!-- main container close-->

{% endblock %}